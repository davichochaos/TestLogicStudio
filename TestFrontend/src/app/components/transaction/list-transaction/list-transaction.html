<div class="container-fluid text-center">
    <div class="row pb-4 pt-4">
        <div class="col-md">
            <h2>Listado de transacciones</h2>
        </div>
    </div>
    <div class="row pb-4">
        <div class="col-md-9">
            <input type="text" class="form-control" placeholder="Fecha o tipo transacción"
                [value]="searchTerm()" (input)="updateSearchTerm($event)">
        </div>
        <div class="col-md text-end">
            <button class="btn btn-outline-primary" type="button" (click)="addTransaction()">Nueva Transacción</button>
            <button class="btn btn-outline-primary" type="button" (click)="listProducts()">Ver productos</button>
        </div>
    </div>
    <div class="row">
        <div class="col-md">
            <table class="table table-striped table-responsive">
                <thead>
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">Fecha transacción</th>
                        <th scope="col">Tipo transacción</th>
                        <th scope="col">Nombre producto</th>
                        <th scope="col">Cantidad</th>
                        <th scope="col">Precio Unitario</th>
                        <th scope="col">Precio total</th>
                        <th scope="col">Detalle transacción</th>
                    </tr>
                </thead>
                <tbody>
                    @for (transaction of paginatedTransactions(); track transaction.transaccionId; let i = $index) {
                    <tr>
                        <td>{{(i + 1) + ((currentPage() -1) * itemsPerPage())}}</td>
                        <td>{{transaction.transaccionFecha | date: 'MMM d, y, HH:mm'}}</td>
                        <td>{{transaction.transaccionTipo}}</td>
                        <td>{{transaction.productoName}}</td>
                        <td>{{transaction.cantidad}}</td>
                        <td>{{transaction.precioUnitario | currency: '$':'symbol':'1.0'}}</td>
                        <td>{{transaction.precioTotal | currency: '$':'symbol':'1.0'}}</td>
                        <td>{{transaction.transaccionDetalle}}</td>
                        <td>
                            <button type="button" class="btn btn-outline-primary" title="Editar"
                                (click)="editTransaction(transaction.transaccionId!)"><i
                                    class="bi bi-pencil"></i></button>
                            <button type="button" class="btn btn-outline-danger" title="Eliminar"
                                (click)="confirmDelete(transaction.transaccionId!)"><i
                                    class="bi bi-trash3"></i></button>
                        </td>
                    </tr>
                    }
                    @empty {
                    <tr>
                        <td colspan="8">
                            <h3 class="emptyData">No hay datos por mostrar</h3>
                        </td>
                    </tr>
                    }
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="8">
                            <nav aria-label="Page navigation">
                                <ul class="pagination justify-content-center">
                                    <li class="page-item" [class.disabled]="currentPage() === 1">
                                        <a class="page-link" aria-label="Previous"
                                            (click)="goToPage(currentPage() - 1)">
                                            <span aria-hidden="true">&laquo;</span>
                                        </a>
                                    </li>
                                    @for (page of [].constructor(totalPages()); track $index) {
                                    <li class="page-item" [class.active]="currentPage() === ($index + 1)">
                                        <a class="page-link" (click)="goToPage($index + 1)">{{ $index + 1
                                            }}</a>
                                    </li>
                                    }
                                    <li class="page-item" [class.disabled]="currentPage() === totalPages()">
                                        <a class="page-link" aria-label="Next"
                                            (click)="goToPage(currentPage() + 1)">
                                            <span aria-hidden="true">&raquo;</span>
                                        </a>
                                    </li>
                                </ul>
                            </nav>
                        </td>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>
</div>
<app-confirm></app-confirm>